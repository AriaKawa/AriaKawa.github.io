<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reaction Time Test</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    background-color: #222;
    color: white;
    margin: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  #start-button {
    padding: 12px 24px;
    margin: 10px auto 20px;
    border: none;
    border-radius: 8px;
    background-color: #4caf50;
    color: #fff;
    font-size: 1em;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.2s;
  }

  #start-button:hover {
    background-color: #43a047;
    transform: translateY(-1px);
  }

  #game-area {
    background-color: red;
    width: 80%;
    max-width: 600px;
    height: 300px;
    margin: 0 auto;
    border-radius: 12px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    font-size: 1.5em;
    user-select: none;
    transition: background-color 0.3s;
  }

  #results {
    margin-top: 20px;
    font-size: 1.2em;
  }
</style>
</head>
<body>
  <h1>Reaction Time Test</h1>
  <p>Click when the screen turns <span style="color:lime">green</span>!</p>
  <button id="start-button" type="button">Start Reaction Time Test</button>
  <div id="game-area" tabindex="0">Click to Start</div>
  <div id="results"></div>

  <script>
    const gameArea = document.getElementById("game-area");
    const results = document.getElementById("results");
    const startButton = document.getElementById("start-button");

    let startTime, timeoutId;
    let waiting = false;
    let canClick = false;
    let tries = 0;
    let scores = [];

    function startRound() {
      gameArea.textContent = "Wait for green...";
      gameArea.style.backgroundColor = "red";
      waiting = true;
      canClick = false;

      const delay = 1000 + Math.random() * 4000; // random 1â€“5 seconds
      timeoutId = setTimeout(() => {
        gameArea.style.backgroundColor = "green";
        gameArea.textContent = "CLICK!";
        startTime = Date.now();
        waiting = false;
        canClick = true;
      }, delay);
    }

    function beginGame() {
      clearTimeout(timeoutId);
      waiting = false;
      canClick = false;
      tries = 0;
      scores = [];
      results.innerHTML = "";
      startRound();
    }

    gameArea.addEventListener("click", () => {
      if (waiting) {
        // Clicked too soon
        clearTimeout(timeoutId);
        gameArea.style.backgroundColor = "red";
        gameArea.textContent = "Too soon! Click to try again.";
        waiting = false;
      } else if (canClick) {
        // Successful click
        const reactionTime = Date.now() - startTime;
        scores.push(reactionTime);
        tries++;
        gameArea.textContent = `Reaction Time: ${reactionTime} ms`;
        gameArea.style.backgroundColor = "#444";
        canClick = false;

        if (tries < 3) {
          setTimeout(() => {
            gameArea.textContent = "Click to start next round";
          }, 1000);
        } else {
          const avg =
            Math.round(scores.reduce((a, b) => a + b, 0) / scores.length);
          results.innerHTML = `
            <p>Tries: ${scores.join(" ms, ")} ms</p>
            <p><strong>Average: ${avg} ms</strong></p>
            <p>Click the box to play again.</p>
          `;
          tries = 0;
          scores = [];
        }
      } else {
        // Start new round
        beginGame();
      }
    });

    startButton.addEventListener("click", () => {
      beginGame();
      gameArea.focus({ preventScroll: true });
    });
  </script>
</body>
</html>
